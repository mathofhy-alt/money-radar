name: Auto Content Generator

on:
  schedule:
    # Runs every 4 hours (00:00, 04:00, 08:00, 12:00, 16:00, 20:00 UTC)
    # UTC 00:00 is KST 09:00
    - cron: '0 */4 * * *'
  workflow_dispatch: # Allows manual trigger from GitHub UI

jobs:
  trigger-automation:
    runs-on: ubuntu-latest
    steps:
      - name: Call Website Cron API
        run: |
          # Try 3 times (loop 0..2)
          for i in {1..3}
          do
             echo "Triggering Post Generation #$i..."
             curl -X GET "${{ secrets.SITE_URL }}/api/cron" \
             -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
             --max-time 60
             
             # Wait 10 seconds between calls to let Vercel breathe
             sleep 10
          done
